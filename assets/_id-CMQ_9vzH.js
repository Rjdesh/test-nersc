import{a as je,b as be,c as ve,g as Me,a1 as _n,d as u,j as e,B as o,T as n,e as Dn,L as w,h as Qe,C as En,f as Ln,P as E,S as Gt,N as Z,Q as J,i as ee,U as te,V as _,W as l,X as ne}from"./index-CYwz6NOt.js";import{u as Bn}from"./useDetailQuery-TTxZ-QLG.js";import{u as $n}from"./useDataFromSource-CYeP9Hjr.js";import{P as O}from"./react-plotly-N1asVEom.js";import{A as Ze,E as re}from"./ExpandMore-BZ0Gu4gS.js";import{N as On}from"./NavigateNext-5cPhuCug.js";import{G as p}from"./Grid-HghZybvF.js";import{A as Je}from"./Alert-D9B5RkcU.js";import{M as v}from"./MenuItem-B8gjdKSY.js";import{T as $}from"./Tooltip-DalGyolZ.js";import{D as H}from"./Divider-BpsEYavU.js";import{C as oe}from"./Collapse-cTI0tGxP.js";import{T as ie,a as se}from"./TableHead-BqJyfmRR.js";import"./useQuery-XriSp-AE.js";import"./index-Chjiymov.js";import"./Close-C-5r-21X.js";import"./dividerClasses-9LCuLCGw.js";var he={},Ft;function qn(){if(Ft)return he;Ft=1;var s=je();Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var h=s(be()),g=ve();return he.default=(0,h.default)((0,g.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),he}var Hn=qn();const _t=Me(Hn);var pe={},Dt;function Vn(){if(Dt)return pe;Dt=1;var s=je();Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var h=s(be()),g=ve();return pe.default=(0,h.default)((0,g.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info"),pe}var Kn=Vn();const Xn=Me(Kn);var ue={},Et;function Yn(){if(Et)return ue;Et=1;var s=je();Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=void 0;var h=s(be()),g=ve();return ue.default=(0,h.default)((0,g.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),ue}var Qn=Yn();const V=Me(Qn);var ge={},Lt;function Zn(){if(Lt)return ge;Lt=1;var s=je();Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=void 0;var h=s(be()),g=ve();return ge.default=(0,h.default)((0,g.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight"),ge}var Jn=Zn();const ae=Me(Jn);var fe={},Bt;function er(){if(Bt)return fe;Bt=1;var s=je();Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var h=s(be()),g=ve();return fe.default=(0,h.default)((0,g.jsx)("path",{d:"M15 9H9v6h6zm-2 4h-2v-2h2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2zm-4 6H7V7h10z"}),"Memory"),fe}var tr=er();const I=Me(tr),r={pageBg:"#f3f4f6",textPrimary:"#111827",textSecondary:"#4b5563",neutralTrack:"#d1d5db",throughputFill:"#0a3a68",cpu:"#3b82f6",gpu:"#10b981",memory:"#f59e0b",network:"#8b5cf6",link:"#2563eb"},nr={fontWeight:700,color:r.textPrimary,letterSpacing:"-0.01em"},G={fontWeight:700,color:r.textPrimary},et={display:"inline-flex",alignItems:"center",gap:.75,color:r.link,fontWeight:500,textDecoration:"none"},N={display:"flex",alignItems:"center",gap:.75,px:1.5,py:.65,borderRadius:"999px",cursor:"pointer"},W={fontSize:"0.875rem",fontWeight:600,lineHeight:1.2},R={fontSize:18},C=s=>Math.min(100,Math.max(0,s)),Le=["circle","square","diamond","triangle-up","triangle-down","cross"],Be=["#1f77b4","#2ca02c","#ff7f0e","#9467bd","#d62728","#17becf","#8c564b","#e377c2","#7f7f7f","#bcbd22","#393b79","#637939"],ye=s=>s==="square"?"■":s==="diamond"?"◆":s==="triangle-up"?"▲":s==="triangle-down"?"▼":s==="cross"?"✚":"●";function rr(s,h){const y=[...(s==null?void 0:s[h])??[]].sort((f,i)=>f["Floored Relative Time"]-i["Floored Relative Time"]),j=Array.from({length:50},(f,i)=>i*2);if(!y.length){const f=j.map((a,m)=>C(30+20*Math.sin(a/12)+m%5*2)),i=f.map((a,m)=>C(a*.72+6+2*Math.cos(m/3)));return[{x:j,y:i,type:"scatter",mode:"lines",name:"CPU",line:{color:r.cpu,width:2}},{x:j,y:f,type:"scatter",mode:"lines",name:"GPU",line:{color:r.gpu,width:2}}]}const b=y.map(f=>Number(f.nersc_ldms_dcgm_gpu_utilization??0)),c=y.map(f=>f["Floored Relative Time"]),P=b,d=b.map((f,i)=>C(f*.7+6+2*Math.cos(i/3)));return[{x:c,y:d,type:"scatter",mode:"lines",name:"CPU",line:{color:r.cpu,width:2}},{x:c,y:P,type:"scatter",mode:"lines+markers",name:"GPU",line:{color:r.gpu,width:2},marker:{size:4}}]}function or(s,h){const y=[...(s==null?void 0:s[h])??[]].sort((a,m)=>a["Floored Relative Time"]-m["Floored Relative Time"]),j=Array.from({length:50},(a,m)=>m*2);if(!y.length){const a=j.map((k,z)=>C(48+16*Math.sin(k/10)+z%4*1.8)),m=a.map((k,z)=>C(k*.78+6+2*Math.cos(z/3)));return[{x:j,y:m,type:"scatter",mode:"lines",name:"CPU Memory",line:{color:"#1976d2",width:2}},{x:j,y:a,type:"scatter",mode:"lines",name:"GPU Memory",line:{color:"#4caf50",width:2}}]}const b=Math.max(...y.map(a=>a["Floored Relative Time"]),1),c=y.map(a=>Number(a.nersc_ldms_dcgm_dram_active??0)),P=Math.max(...c.map(a=>Math.abs(a)),1e-12),d=c.map((a,m)=>C(Math.abs(a)/P*82+8+2.5*Math.sin(m/4))),f=d.map((a,m)=>C(a*.76+7+1.5*Math.cos(m/3))),i=y.map(a=>a["Floored Relative Time"]/b*100);return[{x:i,y:f,type:"scatter",mode:"lines",name:"CPU Memory",line:{color:r.cpu,width:2}},{x:i,y:d,type:"scatter",mode:"lines",name:"GPU Memory",line:{color:r.gpu,width:2}}]}function ir(s,h){const y=[...(s==null?void 0:s[h])??[]].sort((i,a)=>i["Floored Relative Time"]-a["Floored Relative Time"]),j=Array.from({length:50},(i,a)=>a*2);if(!y.length){const i=j.map((m,k)=>Math.max(0,32+10*Math.sin(m/12)+k%4*1.2)),a=i.map((m,k)=>Math.max(0,m*.82+2.5*Math.cos(k/3)));return[{x:j,y:i,type:"scatter",mode:"lines",name:"PCIe Read",line:{color:r.cpu,width:2}},{x:j,y:a,type:"scatter",mode:"lines",name:"PCIe Write",line:{color:r.gpu,width:2}}]}const b=Math.max(...y.map(i=>i["Floored Relative Time"]),1),c=y.map(i=>C(Number(i.nersc_ldms_dcgm_gpu_utilization??0))),P=y.map(i=>i["Floored Relative Time"]/b*100),d=c.map((i,a)=>Math.max(0,i*.64+8+2.5*Math.sin(a/4))),f=d.map((i,a)=>Math.max(0,i*.76+1.8*Math.cos(a/3)));return[{x:P,y:d,type:"scatter",mode:"lines",name:"PCIe Read",line:{color:r.cpu,width:2}},{x:P,y:f,type:"scatter",mode:"lines",name:"PCIe Write",line:{color:r.gpu,width:2}}]}function sr(s,h){const y=[...(s==null?void 0:s[h])??[]].sort((i,a)=>i["Floored Relative Time"]-a["Floored Relative Time"]),j=Array.from({length:50},(i,a)=>a*2);if(!y.length){const i=j.map((m,k)=>Math.max(0,120+36*Math.sin(m/9)+k%4*6)),a=i.map((m,k)=>Math.max(0,m*.58+10+4*Math.cos(k/4)));return[{x:j,y:i,type:"scatter",mode:"lines",name:"GPU Network (NVLink)",line:{color:r.gpu,width:2}},{x:j,y:a,type:"scatter",mode:"lines",name:"Inter-Node Network (Slingshot)",line:{color:r.network,width:2}}]}const b=Math.max(...y.map(i=>i["Floored Relative Time"]),1),c=y.map(i=>C(Number(i.nersc_ldms_dcgm_gpu_utilization??0))),P=y.map(i=>i["Floored Relative Time"]/b*100),d=c.map((i,a)=>Math.max(0,i*1.9+36+4*Math.sin(a/4))),f=d.map((i,a)=>Math.max(0,i*.56+6+2.2*Math.cos(a/3)));return[{x:P,y:d,type:"scatter",mode:"lines",name:"GPU Network (NVLink)",line:{color:r.gpu,width:2}},{x:P,y:f,type:"scatter",mode:"lines",name:"Inter-Node Network (Slingshot)",line:{color:r.network,width:2}}]}function $t(s,h,g){const y=s.length>0?s.reduce((b,c)=>b+c,0)/s.length:0,j=h.length>0?h.reduce((b,c)=>b+c,0)/h.length:0;return Array.from({length:12},(b,c)=>{const P=`nid${String(8670+c).padStart(6,"0")}`,d=Le[c%Le.length],f=Be[c%Be.length],i=s.map((z,L)=>Math.max(0,z*(.8+c*.02)+2*Math.sin(L/5+c))),a=h.map((z,L)=>Math.max(0,z*(.82+c*.018)+1.6*Math.cos(L/6+c))),m=y*(.8+c*.02),k=j*(.82+c*.018);return{node:P,color:f,symbol:d,time:g,readSeries:i,writeSeries:a,readMean:m,readMin:m*.74,readMax:m*1.22,writeMean:k,writeMin:k*.76,writeMax:k*1.2}})}function ar(){const s=Array.from({length:50},(h,g)=>g*2);return[{x:s,y:s.map(()=>35+Math.random()*10),type:"scatter",mode:"lines",name:"CPU",line:{color:r.cpu,width:2}},{x:s,y:s.map(()=>165+Math.random()*10),type:"scatter",mode:"lines",name:"GPU",line:{color:r.gpu,width:2}},{x:s,y:s.map(()=>345+Math.random()*15),type:"scatter",mode:"lines",name:"Memory",line:{color:r.memory,width:2}},{x:s,y:s.map(()=>240+Math.random()*15),type:"scatter",mode:"lines",name:"Node",line:{color:r.network,width:2}}]}function lr(){const g=(d,f,i,a,m)=>Array.from({length:i},()=>({x:Math.max(0,Math.min(10,d+(Math.random()-.5)*a)),y:Math.max(0,Math.min(25,f+(Math.random()-.5)*m))})),y=[...g(2,15,90,.8,4),...g(2.8,13,60,.6,3.5),...g(3.4,14,50,.6,3),...g(4.2,13,30,.45,2.8),...g(5.4,12,10,.3,1.8)],j=.2,b=2,c=new Map;y.forEach(d=>{const f=Math.round(d.x/j)*j,i=Math.round(d.y/b)*b,a=`${f.toFixed(2)}-${i.toFixed(2)}`,m=c.get(a);m?m.count+=1:c.set(a,{x:f,y:i,count:1})});const P=[...c.values()];return[{x:[0,1.7,9.9],y:[0,21.5,21.5],type:"scatter",mode:"lines",name:"Roofline Boundary",line:{color:r.cpu,width:4}},{x:[1.7,1.7],y:[0,25],type:"scatter",mode:"lines",name:"Ridge Point",line:{color:r.network,width:2,dash:"dot"}},{x:[null],y:[null],type:"scatter",mode:"markers",name:"Actual Performance",marker:{symbol:"square",size:10,color:r.memory},hoverinfo:"skip"},{x:P.map(d=>d.x),y:P.map(d=>d.y),type:"scatter",mode:"markers",showlegend:!1,marker:{symbol:"square",size:15,color:P.map(d=>d.count),colorscale:[[0,"#e5e7eb"],[.25,"#e8c99c"],[.5,"#d9a354"],[.75,"#c7740a"],[1,"#8a4f00"]],cmin:1,cmax:Math.max(40,...P.map(d=>d.count)),showscale:!0,colorbar:{title:{text:"No. of Kernels"},tickvals:[1,10,20,30,40]},line:{color:"#ffffff",width:0}},customdata:P.map(d=>d.count),hovertemplate:"Operational Intensity: %{x:.2f}<br>Performance: %{y:.1f} GFLOPS<br>Kernels: %{customdata}<extra></extra>"},{x:[1.7+.05],y:[21.5+.6],type:"scatter",mode:"text",showlegend:!1,text:["Ridge Point"],textposition:"top left",textfont:{color:r.network,size:16},hoverinfo:"skip"}]}function Ot(s,h,g){const y=s.length>0?s.reduce((b,c)=>b+c,0)/s.length:0,j=h.length>0?h.reduce((b,c)=>b+c,0)/h.length:0;return Array.from({length:12},(b,c)=>{const P=`nid${String(8670+c).padStart(6,"0")}`,d=Le[c%Le.length],f=Be[c%Be.length],i=s.map((z,L)=>C(z*(.78+c*.018)+2*Math.cos(L/4+c))),a=h.map((z,L)=>C(z*(.82+c*.02)+2.5*Math.sin(L/5+c))),m=C(y*(.78+c*.02)),k=C(j*(.82+c*.018));return{node:P,color:f,symbol:d,time:g,cpuSeries:i,gpuSeries:a,cpuMean:m,cpuMin:C(m*.72),cpuMax:C(m*1.24),gpuMean:k,gpuMin:C(k*.74),gpuMax:C(k*1.22)}})}const Cr=function(){var bt,vt,Mt,Pt,kt,wt,Ct,St,zt,Ut,It,Nt,Wt,Rt,Tt,At;const{id:h}=_n.useParams(),[g,y]=u.useState(!1),[j,b]=u.useState(!1),[c,P]=u.useState("mean"),[d,f]=u.useState("mean"),[i,a]=u.useState(!0),[m,k]=u.useState(!0),[z,L]=u.useState(!1),[U,qt]=u.useState("mean"),[Pe,Ht]=u.useState(!0),[ke,Vt]=u.useState(!0),[$e,tt]=u.useState(!1),[T,Kt]=u.useState("mean"),[we,Xt]=u.useState(!0),[Ce,Yt]=u.useState(!0),[Oe,nt]=u.useState(!1),[F,Qt]=u.useState("mean"),[Se,Zt]=u.useState(!0),[ze,Jt]=u.useState(!0),[qe,en]=u.useState(!0),[He,tn]=u.useState(!0),[Ve,nn]=u.useState(!0),[Ke,rn]=u.useState(!0),[Xe,rt]=u.useState(!1),[A,on]=u.useState("mean"),[le,sn]=u.useState(!0),[ce,an]=u.useState(!0),[M,ln]=u.useState("job-details");u.useEffect(()=>{d==="all"&&y(!0)},[d]),u.useEffect(()=>{U==="all"&&L(!0)},[U]),u.useEffect(()=>{T==="all"&&tt(!0)},[T]),u.useEffect(()=>{F==="all"&&nt(!0)},[F]),u.useEffect(()=>{A==="all"&&rt(!0)},[A]);const{data:de}=Bn({dataSource:"data/user-job-performance/user-jobs.json",dataIdField:"Job ID",paramId:h,queryMode:"client",staticParams:null}),Ue=$n("data/user-job-performance/metrics-data.json");u.useEffect(()=>{const t=()=>{const x=["job-details","insights","gpu-throughput","runtime-resource-distribution","resource-util","memory-util","gpu-performance","gpu-inter-node-network","power","pcie-bandwidth","roofline"],S=window.scrollY+100;for(let B=x.length-1;B>=0;B--){const Ee=document.getElementById(x[B]);if(Ee&&Ee.offsetTop<=S){ln(x[B]);break}}};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]);const D=t=>{const x=document.getElementById(t);if(x){const Ee=x.offsetTop-80;window.scrollTo({top:Ee,behavior:"smooth"})}},K=rr(Ue,h),X=ar(),cn=lr(),Ie=((bt=K.find(t=>t.name==="CPU"))==null?void 0:bt.y)??[],Ne=((vt=K.find(t=>t.name==="GPU"))==null?void 0:vt.y)??[],dn=((Mt=K.find(t=>t.name==="CPU"))==null?void 0:Mt.x)??[],xn=Ie.length?Ie.reduce((t,x)=>t+x,0)/Ie.length:0,ot=Ne.length?Ne.reduce((t,x)=>t+x,0)/Ne.length:0,it=K.filter(t=>t.name==="CPU"&&i||t.name==="GPU"&&m),Y=Ot(Ie,Ne,dn),mn=d==="all"?Y.map(t=>({color:t.color,symbol:t.symbol,node:t.node,cpu:t.cpuMean,gpu:t.gpuMean})):Y.map(t=>({color:t.color,symbol:t.symbol,node:t.node,cpu:d==="max"?t.cpuMax:d==="min"?t.cpuMin:t.cpuMean,gpu:d==="max"?t.gpuMax:d==="min"?t.gpuMin:t.gpuMean})),st=d==="max"?"Max.":d==="min"?"Min.":"Avg.",hn=d==="all"?Y.flatMap(t=>{const x=[];return i&&x.push({x:t.time,y:t.cpuSeries,type:"scatter",mode:"lines+markers",name:`${t.node} CPU`,line:{color:t.color,width:1.6,dash:"dot"},marker:{symbol:t.symbol,size:5}}),m&&x.push({x:t.time,y:t.gpuSeries,type:"scatter",mode:"lines+markers",name:`${t.node} GPU`,line:{color:t.color,width:1.8},marker:{symbol:t.symbol,size:5}}),x}):it.length?it:K,pn=((Pt=X.find(t=>t.name==="CPU"))==null?void 0:Pt.y)??[],un=((kt=X.find(t=>t.name==="GPU"))==null?void 0:kt.y)??[],gn=((wt=X.find(t=>t.name==="Memory"))==null?void 0:wt.y)??[],fn=((Ct=X.find(t=>t.name==="Node"))==null?void 0:Ct.y)??[],We=t=>t.length?t.reduce((x,S)=>x+S,0)/t.length:0,at=We(pn),lt=We(un),ct=We(gn),dt=We(fn),xt=X.filter(t=>t.name==="CPU"&&qe||t.name==="GPU"&&He||t.name==="Memory"&&Ve||t.name==="Node"&&Ke),Re=c==="max"?"Max.":c==="min"?"Min.":"Avg.",yn=Y.map((t,x)=>{const S=.84+x*.025,B=c==="max"?1.16:c==="min"?.82:1;return{node:t.node,cpu:at*S*B,gpu:lt*S*B,mem:ct*S*B,nodePower:dt*S*B}}),q=ir(Ue,h),Te=((St=q.find(t=>t.name==="PCIe Read"))==null?void 0:St.y)??[],Ae=((zt=q.find(t=>t.name==="PCIe Write"))==null?void 0:zt.y)??[],jn=((Ut=q.find(t=>t.name==="PCIe Read"))==null?void 0:Ut.x)??[],bn=Te.length?Te.reduce((t,x)=>t+x,0)/Te.length:0,vn=Ae.length?Ae.reduce((t,x)=>t+x,0)/Ae.length:0,Ye=$t(Te,Ae,jn),Mn=Ye.map(t=>({color:t.color,symbol:t.symbol,node:t.node,read:A==="max"?t.readMax:A==="min"?t.readMin:t.readMean,write:A==="max"?t.writeMax:A==="min"?t.writeMin:t.writeMean})),mt=A==="max"?"Max.":A==="min"?"Min.":"Avg.",Pn=A==="all"?Ye.map(t=>({x:t.time,y:t.readSeries,type:"scatter",mode:"lines+markers",name:`${t.node} Read`,line:{color:t.color,width:1.8},marker:{symbol:t.symbol,size:5}})):le?[q.find(t=>t.name==="PCIe Read")]:[],kn=A==="all"?Ye.map(t=>({x:t.time,y:t.writeSeries,type:"scatter",mode:"lines+markers",name:`${t.node} Write`,line:{color:t.color,width:1.8},marker:{symbol:t.symbol,size:5}})):ce?[q.find(t=>t.name==="PCIe Write")]:[],wn=A==="all"?[...le?Pn:[],...ce?kn:[]]:[...le?[q.find(t=>t.name==="PCIe Read")]:[],...ce?[q.find(t=>t.name==="PCIe Write")]:[]],Q=or(Ue,h),Ge=((It=Q.find(t=>t.name==="CPU Memory"))==null?void 0:It.y)??[],Fe=((Nt=Q.find(t=>t.name==="GPU Memory"))==null?void 0:Nt.y)??[],Cn=((Wt=Q.find(t=>t.name==="CPU Memory"))==null?void 0:Wt.x)??[],Sn=Ge.length?Ge.reduce((t,x)=>t+x,0)/Ge.length:0,ht=Fe.length?Fe.reduce((t,x)=>t+x,0)/Fe.length:0,pt=Q.filter(t=>t.name==="CPU Memory"&&we||t.name==="GPU Memory"&&Ce),xe=Ot(Ge,Fe,Cn),zn=T==="all"?xe.map(t=>({color:t.color,symbol:t.symbol,node:t.node,cpu:t.cpuMean,gpu:t.gpuMean})):xe.map(t=>({color:t.color,symbol:t.symbol,node:t.node,cpu:T==="max"?t.cpuMax:T==="min"?t.cpuMin:t.cpuMean,gpu:T==="max"?t.gpuMax:T==="min"?t.gpuMin:t.gpuMean})),ut=T==="max"?"Max.":T==="min"?"Min.":"Avg.",Un=T==="all"?xe.flatMap(t=>{const x=[];return we&&x.push({x:t.time,y:t.cpuSeries,type:"scatter",mode:"lines+markers",name:`${t.node} CPU Memory`,line:{color:t.color,width:1.6,dash:"dot"},marker:{symbol:t.symbol,size:5}}),Ce&&x.push({x:t.time,y:t.gpuSeries,type:"scatter",mode:"lines+markers",name:`${t.node} GPU Memory`,line:{color:t.color,width:1.8},marker:{symbol:t.symbol,size:5}}),x}):pt.length?pt:Q,In=xe.map((t,x)=>{const S=Y[x]??t;return{color:S.color,symbol:S.symbol,node:S.node,gpuUtilization:U==="max"?S.gpuMax:U==="min"?S.gpuMin:S.gpuMean,gpuMemoryUtilization:U==="max"?t.gpuMax:U==="min"?t.gpuMin:t.gpuMean}}),gt=U==="max"?"Max.":U==="min"?"Min.":"Avg.",Nn=U==="all"?Pe?Y.map(t=>({x:t.time,y:t.gpuSeries,type:"scatter",mode:"lines+markers",name:t.node,line:{color:r.gpu,width:1.8},marker:{symbol:t.symbol,size:5}})):[]:Pe?K.filter(t=>t.name==="GPU").map(t=>({...t,line:{...t.line??{},color:r.gpu}})):[],Wn=U==="all"?ke?xe.map(t=>({x:t.time,y:t.gpuSeries,type:"scatter",mode:"lines+markers",name:t.node,line:{color:r.memory,width:1.8},marker:{symbol:t.symbol,size:5}})):[]:ke?Q.filter(t=>t.name==="GPU Memory").map(t=>({...t,line:{...t.line??{},color:r.memory}})):[],me=sr(Ue,h),_e=((Rt=me.find(t=>t.name==="GPU Network (NVLink)"))==null?void 0:Rt.y)??[],De=((Tt=me.find(t=>t.name==="Inter-Node Network (Slingshot)"))==null?void 0:Tt.y)??[],Rn=((At=me.find(t=>t.name==="GPU Network (NVLink)"))==null?void 0:At.x)??[],Tn=_e.length?_e.reduce((t,x)=>t+x,0)/_e.length:0,An=De.length?De.reduce((t,x)=>t+x,0)/De.length:0,ft=me.filter(t=>t.name==="GPU Network (NVLink)"&&Se||t.name==="Inter-Node Network (Slingshot)"&&ze),yt=$t(_e,De,Rn),Gn=yt.map(t=>({color:t.color,symbol:t.symbol,node:t.node,nvlink:F==="max"?t.readMax:F==="min"?t.readMin:t.readMean,slingshot:F==="max"?t.writeMax:F==="min"?t.writeMin:t.writeMean})),jt=F==="max"?"Max.":F==="min"?"Min.":"Avg.",Fn=F==="all"?yt.flatMap(t=>{const x=[];return Se&&x.push({x:t.time,y:t.readSeries,type:"scatter",mode:"lines+markers",name:`${t.node} NVLink`,line:{color:t.color,width:1.8},marker:{symbol:t.symbol,size:5}}),ze&&x.push({x:t.time,y:t.writeSeries,type:"scatter",mode:"lines+markers",name:`${t.node} Slingshot`,line:{color:t.color,width:1.6,dash:"dot"},marker:{symbol:t.symbol,size:5}}),x}):ft.length?ft:me;return de?e.jsxs(o,{sx:{bgcolor:r.pageBg,minHeight:"100vh",pb:4},children:[e.jsx(o,{sx:{bgcolor:"white",borderBottom:"1px solid #e0e0e0",px:3,py:1.5,position:"sticky",top:0,zIndex:2},children:e.jsxs(Dn,{separator:e.jsx(On,{fontSize:"small"}),children:[e.jsx(w,{component:Qe,to:"/user-job-performance",underline:"hover",color:"primary",children:"For Users"}),e.jsx(w,{component:Qe,to:"/user-job-performance",underline:"hover",color:"primary",children:"Performance Overview"}),e.jsxs(n,{color:"text.primary",children:["Details for Job ",de["Job ID"]]})]})}),e.jsxs(En,{maxWidth:"xl",sx:{mt:3},children:[e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,md:10,children:e.jsxs(o,{sx:{mb:3},children:[e.jsxs(n,{variant:"h4",sx:{...nr,mb:2},children:["Performance for Job : ",de["Job ID"]," (",de.Project,")"]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(o,{sx:{flex:1}}),e.jsx(Ln,{component:Qe,to:"/user-job-performance/compare",variant:"outlined",endIcon:e.jsx(V,{}),size:"medium",sx:{textTransform:"none",borderColor:"#1a2f5a",color:"#1a2f5a","&:hover":{borderColor:"#1a2f5a",bgcolor:"rgba(26, 47, 90)",color:"#ffffff"}},children:"Compare with other Jobs"})]})]})}),e.jsx(p,{item:!0,xs:12,md:2})]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{item:!0,xs:12,md:!0,children:[e.jsxs(E,{id:"job-details",sx:{p:2,mb:3,scrollMarginTop:"80px"},children:[e.jsx(n,{variant:"h5",sx:{...G,mb:2},children:"Job Details"}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Start time"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Fri Jul 7, 2025 18:32 PT"})]}),e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"End time"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Fri Jul 7, 2025 21:12 PT"})]}),e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Duration"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"2 hrs 40 min"})]}),e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Queue"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:de.QOS})]}),e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"No. of Nodes"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"233"})]}),e.jsxs(p,{item:!0,xs:6,sm:4,md:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Node Hours Charged"}),e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"24.36"})]})]})]}),e.jsxs(E,{id:"insights",sx:{p:2,mb:3,scrollMarginTop:"80px"},children:[e.jsx(n,{variant:"h5",sx:{...G,mb:2},children:"Insights & Hints"}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(Je,{severity:"warning",variant:"outlined",icon:e.jsx(_t,{}),sx:{height:"100%",color:r.textPrimary,"& .MuiAlertTitle-root":{color:r.textPrimary},"& .MuiTypography-root":{color:r.textPrimary},"& a":{color:r.link}},children:[e.jsx(Ze,{sx:{fontWeight:600},children:"Compute bound performance"}),e.jsx(n,{variant:"body2",sx:{mb:1},children:"Consider improving vectorization or use multi-threading. Review roofline analysis chart in the performance summary for more details."}),e.jsxs(w,{href:"#",variant:"body2",sx:{display:"flex",alignItems:"center",gap:.5},children:["Learn about Roofline Analysis"," ",e.jsx(V,{fontSize:"small"})]})]})}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(Je,{severity:"warning",variant:"outlined",icon:e.jsx(_t,{}),sx:{height:"100%",color:r.textPrimary,"& .MuiAlertTitle-root":{color:r.textPrimary},"& .MuiTypography-root":{color:r.textPrimary},"& a":{color:r.link}},children:[e.jsx(Ze,{sx:{fontWeight:600},children:"Network imbalance detected"}),e.jsx(n,{variant:"body2",sx:{mb:1},children:"High I/O or CPU utilization imbalance across ~20% of nodes. Distribute network traffic evenly across available nodes to improve potential performance."}),e.jsxs(w,{href:"#",variant:"body2",sx:{display:"flex",alignItems:"center",gap:.5},children:["Learn about Network Performance"," ",e.jsx(V,{fontSize:"small"})]})]})}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(Je,{severity:"info",variant:"outlined",icon:e.jsx(Xn,{}),sx:{height:"100%",color:r.textPrimary,"& .MuiAlertTitle-root":{color:r.textPrimary},"& .MuiTypography-root":{color:r.textPrimary},"& a":{color:r.link}},children:[e.jsx(Ze,{sx:{fontWeight:600},children:"Explore power capping"}),e.jsx(n,{variant:"body2",sx:{mb:1},children:"Prepare for power-limited compute landscape. Power capping can offer incentives of node hour discounts, priority boosts, or access to free queues."}),e.jsxs(w,{href:"#",variant:"body2",sx:{display:"flex",alignItems:"center",gap:.5},children:["Learn about Power Capping"," ",e.jsx(V,{fontSize:"small"})]})]})})]})]}),e.jsxs(p,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(p,{item:!0,xs:12,lg:6,children:e.jsxs(E,{id:"gpu-throughput",sx:{p:4,height:"100%",scrollMarginTop:"80px"},children:[e.jsx(n,{variant:"h5",sx:{...G,mb:4},children:"GPU Throughput Overview"}),[{label:"Compute (SM) Throughput",value:39.88},{label:"Memory Throughput",value:80.88},{label:"DRAM Throughput",value:80.88}].map(t=>e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:"280px 1fr 80px",alignItems:"center",gap:2,mb:4},children:[e.jsx(n,{variant:"subtitle1",sx:{...G,fontWeight:600},children:t.label}),e.jsx(o,{sx:{height:20,borderRadius:.5,bgcolor:r.neutralTrack,overflow:"hidden"},children:e.jsx(o,{sx:{width:`${t.value}%`,height:"100%",bgcolor:r.throughputFill}})}),e.jsxs(n,{variant:"body1",sx:{fontWeight:500},children:[t.value.toFixed(2),"%"]})]},t.label)),e.jsx(n,{variant:"body1",sx:{maxWidth:760,mb:2,color:r.textSecondary},children:"Kernel shows high throughput, using >80% of available compute or memory. Consider shifting work off the bottleneck, further analyze DRAM to investigate more."}),e.jsxs(w,{href:"#",sx:et,children:["See more GPU throughput metrics ",e.jsx(V,{})]})]})}),e.jsx(p,{item:!0,xs:12,lg:6,children:e.jsxs(E,{id:"runtime-resource-distribution",sx:{p:3,height:"100%",scrollMarginTop:"80px"},children:[e.jsx(n,{variant:"h5",sx:{...G,mb:2},children:"Runtime Resource Distribution"}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsxs(p,{item:!0,xs:12,md:5,children:[e.jsx(Gt,{spacing:2.5,sx:{mt:2},children:[{label:"GPU",value:"52.3%",color:r.cpu},{label:"I/O",value:"62.4%",color:r.gpu},{label:"CPU",value:"62.4%",color:r.memory},{label:"Network",value:"62.4%",color:r.network}].map(t=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(I,{sx:{color:t.color}}),e.jsx(n,{variant:"subtitle1",sx:{...G,minWidth:86},children:t.label}),e.jsx(n,{variant:"subtitle1",children:t.value})]},t.label))}),e.jsxs(w,{href:"#",sx:{...et,mt:4},children:["Learn about Efficient Resource Distribution"," ",e.jsx(V,{})]})]}),e.jsx(p,{item:!0,xs:12,md:7,children:e.jsx(O,{data:[{type:"pie",hole:.62,values:[35,45,20,25],labels:["GPU","I/O","CPU","Network"],text:["35%","45%","20%","25%"],textinfo:"text",texttemplate:"%{label}<br>%{text}",textposition:"inside",insidetextorientation:"horizontal",sort:!1,marker:{colors:[r.cpu,r.gpu,r.memory,r.network],line:{color:r.pageBg,width:6}},hoverinfo:"label+percent",showlegend:!1}],layout:{autosize:!0,height:360,margin:{l:10,r:10,t:10,b:10},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}})})]})]})})]}),e.jsxs(E,{id:"resource-util",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(n,{variant:"h5",sx:G,children:"GPU & CPU Utilization"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Aggregation"}),e.jsxs(J,{value:d,onChange:t=>f(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"}),e.jsx(v,{value:"all",children:"See all nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx($,{arrow:!0,placement:"top",title:"Avg. CPU utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>a(!i),sx:{...N,border:`2px solid ${r.cpu}`,opacity:i?1:.45},children:[e.jsx(I,{sx:{...R,color:r.cpu}}),e.jsxs(n,{sx:W,children:["CPU ",xn.toFixed(1),"%"]})]})}),e.jsx($,{arrow:!0,placement:"top",title:"Avg. GPU utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>k(!m),sx:{...N,border:`2px solid ${r.gpu}`,opacity:m?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["GPU ",ot.toFixed(1),"%"]})]})})]})]}),e.jsx(O,{data:hn,layout:{autosize:!0,height:330,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Floored Relative Time (s)"},yaxis:{title:"Utilization %",range:[0,100]},showlegend:d==="all",legend:d==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:void 0,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{id:"util-nodes",sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>y(!g),children:[e.jsx(ee,{size:"small",children:g?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular data across individual nodes"})]}),e.jsx(oe,{in:g,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Legend"}),e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[st," CPU Utilization"]}),e.jsxs(l,{sx:{fontWeight:700},children:[st," GPU Utilization"]})]})}),e.jsx(ne,{children:mn.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:e.jsx(n,{variant:"body1",sx:{color:t.color,lineHeight:1},children:ye(t.symbol)})}),e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.cpu.toFixed(3),"%"]}),e.jsxs(l,{children:[t.gpu.toFixed(3),"%"]})]},t.node))})]})})})})]}),e.jsxs(E,{id:"memory-util",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(n,{variant:"h5",sx:G,children:"Memory Utilization"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Aggregation"}),e.jsxs(J,{value:T,onChange:t=>Kt(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"}),e.jsx(v,{value:"all",children:"See all nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx($,{arrow:!0,placement:"top",title:"Avg. CPU memory utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>Xt(!we),sx:{...N,border:`2px solid ${r.cpu}`,opacity:we?1:.45},children:[e.jsx(I,{sx:{...R,color:r.cpu}}),e.jsxs(n,{sx:W,children:["CPU Memory ",Sn.toFixed(1),"%"]})]})}),e.jsx($,{arrow:!0,placement:"top",title:"Avg. GPU memory utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>Yt(!Ce),sx:{...N,border:`2px solid ${r.gpu}`,opacity:Ce?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["GPU Memory ",ht.toFixed(1),"%"]})]})})]})]}),e.jsx(O,{data:Un,layout:{autosize:!0,height:330,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Relative Time",tickvals:[0,12.5,25,37,47,58,68,78,88,100],ticktext:["0%","12%","25%","37%","47%","58%","68%","78%","88%","100%"]},yaxis:{title:"Memory Utilization %",range:[0,100]},showlegend:T==="all",legend:T==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:void 0,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{id:"memory-nodes",sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>tt(!$e),children:[e.jsx(ee,{size:"small",children:$e?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular memory data across individual nodes"})]}),e.jsx(oe,{in:$e,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Legend"}),e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[ut," CPU Memory"]}),e.jsxs(l,{sx:{fontWeight:700},children:[ut," GPU Memory"]})]})}),e.jsx(ne,{children:zn.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:e.jsx(n,{variant:"body1",sx:{color:t.color,lineHeight:1},children:ye(t.symbol)})}),e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.cpu.toFixed(3),"%"]}),e.jsxs(l,{children:[t.gpu.toFixed(3),"%"]})]},`memory-${t.node}`))})]})})})})]}),e.jsxs(E,{id:"gpu-performance",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(n,{variant:"h5",sx:G,children:"GPU Performance"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Aggregation"}),e.jsxs(J,{value:U,onChange:t=>qt(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"}),e.jsx(v,{value:"all",children:"See all nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx($,{arrow:!0,placement:"top",title:"Avg. GPU utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>Ht(!Pe),sx:{...N,border:`2px solid ${r.gpu}`,opacity:Pe?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["GPU Utilization ",ot.toFixed(1),"%"]})]})}),e.jsx($,{arrow:!0,placement:"top",title:"Avg. GPU memory utilization across all nodes for the selected job.",children:e.jsxs(o,{onClick:()=>Vt(!ke),sx:{...N,border:`2px solid ${r.memory}`,opacity:ke?1:.45},children:[e.jsx(I,{sx:{...R,color:r.memory}}),e.jsxs(n,{sx:W,children:["GPU Memory ",ht.toFixed(1),"%"]})]})})]})]}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"GPU Utilization"}),e.jsx(O,{data:Nn.filter(Boolean),layout:{autosize:!0,height:320,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Floored Relative Time (s)"},yaxis:{title:"GPU Utilization %",range:[0,100]},showlegend:U==="all",legend:U==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:void 0,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}})]}),e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"GPU Memory"}),e.jsx(O,{data:Wn.filter(Boolean),layout:{autosize:!0,height:320,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Relative Time",tickvals:[0,12.5,25,37,47,58,68,78,88,100],ticktext:["0%","12%","25%","37%","47%","58%","68%","78%","88%","100%"]},yaxis:{title:"GPU Memory Utilization %",range:[0,100]},showlegend:U==="all",legend:U==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:void 0,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}})]})]}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{id:"gpu-performance-nodes",sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>L(!z),children:[e.jsx(ee,{size:"small",children:z?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular GPU performance data across individual nodes"})]}),e.jsx(oe,{in:z,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Legend"}),e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[gt," GPU Utilization"]}),e.jsxs(l,{sx:{fontWeight:700},children:[gt," GPU Memory"]})]})}),e.jsx(ne,{children:In.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:e.jsx(n,{variant:"body1",sx:{color:t.color,lineHeight:1},children:ye(t.symbol)})}),e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.gpuUtilization.toFixed(3),"%"]}),e.jsxs(l,{children:[t.gpuMemoryUtilization.toFixed(3),"%"]})]},`gpu-performance-${t.node}`))})]})})})})]}),e.jsxs(E,{id:"power",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:2},children:e.jsx(n,{variant:"h6",sx:G,children:"Power"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"Aggregation"}),e.jsxs(J,{value:c,onChange:t=>P(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:1.5,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs(o,{onClick:()=>en(!qe),sx:{...N,border:`2px solid ${r.cpu}`,opacity:qe?1:.45},children:[e.jsx(I,{sx:{...R,color:r.cpu}}),e.jsxs(n,{sx:W,children:["CPU ",at.toFixed(1)," W"]})]}),e.jsxs(o,{onClick:()=>tn(!He),sx:{...N,border:`2px solid ${r.gpu}`,opacity:He?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["GPU ",lt.toFixed(1)," W"]})]}),e.jsxs(o,{onClick:()=>nn(!Ve),sx:{...N,border:`2px solid ${r.memory}`,opacity:Ve?1:.45},children:[e.jsx(I,{sx:{...R,color:r.memory}}),e.jsxs(n,{sx:W,children:["Memory ",ct.toFixed(1)," W"]})]}),e.jsxs(o,{onClick:()=>rn(!Ke),sx:{...N,border:`2px solid ${r.network}`,opacity:Ke?1:.45},children:[e.jsx(I,{sx:{...R,color:r.network}}),e.jsxs(n,{sx:W,children:["Node ",dt.toFixed(1)," W"]})]})]})]}),e.jsx(O,{data:xt.length?xt:X,layout:{autosize:!0,height:300,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Relative Time",showline:!0,showticklabels:!0,ticks:"outside",tickvals:[0,12.5,25,37,47,58,68,78,88,100],ticktext:["0%","12%","25%","37%","47%","58%","68%","78%","88%","100%"]},yaxis:{title:"Power (W)"},showlegend:!1,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{id:"power-nodes",sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>b(!j),children:[e.jsx(ee,{size:"small",children:j?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular power data across individual nodes"})]}),e.jsx(oe,{in:j,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[Re," CPU Power"]}),e.jsxs(l,{sx:{fontWeight:700},children:[Re," GPU Power"]}),e.jsxs(l,{sx:{fontWeight:700},children:[Re," Memory Power"]}),e.jsxs(l,{sx:{fontWeight:700},children:[Re," Node Power"]})]})}),e.jsx(ne,{children:yn.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.cpu.toFixed(3)," W"]}),e.jsxs(l,{children:[t.gpu.toFixed(3)," W"]}),e.jsxs(l,{children:[t.mem.toFixed(3)," W"]}),e.jsxs(l,{children:[t.nodePower.toFixed(3)," W"]})]},`power-${t.node}`))})]})})})})]}),e.jsxs(E,{id:"pcie-bandwidth",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(n,{variant:"h5",sx:G,children:"PCIe Bandwidth"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Aggregation"}),e.jsxs(J,{value:A,onChange:t=>on(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"}),e.jsx(v,{value:"all",children:"See all nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:1.5,alignItems:"center"},children:[e.jsx($,{arrow:!0,placement:"top",title:"Average PCIe read bandwidth across nodes.",children:e.jsxs(o,{onClick:()=>sn(!le),sx:{...N,border:`2px solid ${r.cpu}`,opacity:le?1:.45},children:[e.jsx(I,{sx:{...R,color:r.cpu}}),e.jsxs(n,{sx:W,children:["Read ",bn.toFixed(1)," GB/s"]})]})}),e.jsx($,{arrow:!0,placement:"top",title:"Average PCIe write bandwidth across nodes.",children:e.jsxs(o,{onClick:()=>an(!ce),sx:{...N,border:`2px solid ${r.gpu}`,opacity:ce?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["Write ",vn.toFixed(1)," GB/s"]})]})})]})]}),e.jsx(O,{data:wn.filter(Boolean),layout:{autosize:!0,height:330,margin:{l:60,r:20,t:20,b:50},xaxis:{title:"Relative Time",tickvals:[0,12.5,25,37,47,58,68,78,88,100],ticktext:["0%","12%","25%","37%","47%","58%","68%","78%","88%","100%"]},yaxis:{title:"PCIe Bandwidth (GB/s)",rangemode:"tozero"},showlegend:!1,legend:A==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:{orientation:"h",x:.5,y:1.12,xanchor:"center"},hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>rt(!Xe),children:[e.jsx(ee,{size:"small",children:Xe?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular PCIe bandwidth data across individual nodes"})]}),e.jsx(oe,{in:Xe,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Legend"}),e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[mt," PCIe Read"]}),e.jsxs(l,{sx:{fontWeight:700},children:[mt," PCIe Write"]})]})}),e.jsx(ne,{children:Mn.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:e.jsx(n,{variant:"body1",sx:{color:t.color,lineHeight:1},children:ye(t.symbol)})}),e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.read.toFixed(3)," GB/s"]}),e.jsxs(l,{children:[t.write.toFixed(3)," GB/s"]})]},`pcie-${t.node}`))})]})})})})]}),e.jsxs(E,{id:"gpu-inter-node-network",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(n,{variant:"h5",sx:G,children:"GPU and Inter-Node Network"})}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[e.jsxs(Z,{size:"small",sx:{minWidth:220},children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:.5},children:"Aggregation"}),e.jsxs(J,{value:F,onChange:t=>Qt(t.target.value),children:[e.jsx(v,{value:"mean",children:"Mean across Nodes"}),e.jsx(v,{value:"min",children:"Min across Nodes"}),e.jsx(v,{value:"max",children:"Max across Nodes"}),e.jsx(v,{value:"all",children:"See all nodes"})]})]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx($,{arrow:!0,placement:"top",title:"Avg. intra-node GPU network traffic over NVLink.",children:e.jsxs(o,{onClick:()=>Zt(!Se),sx:{...N,border:`2px solid ${r.gpu}`,opacity:Se?1:.45},children:[e.jsx(I,{sx:{...R,color:r.gpu}}),e.jsxs(n,{sx:W,children:["NVLink ",Tn.toFixed(1)," GB/s"]})]})}),e.jsx($,{arrow:!0,placement:"top",title:"Avg. inter-node network traffic over Slingshot.",children:e.jsxs(o,{onClick:()=>Jt(!ze),sx:{...N,border:`2px solid ${r.network}`,opacity:ze?1:.45},children:[e.jsx(I,{sx:{...R,color:r.network}}),e.jsxs(n,{sx:W,children:["Slingshot ",An.toFixed(1)," GB/s"]})]})})]})]}),e.jsx(O,{data:Fn,layout:{autosize:!0,height:330,margin:{l:60,r:20,t:20,b:50},xaxis:{title:"Relative Time",tickvals:[0,12.5,25,37,47,58,68,78,88,100],ticktext:["0%","12%","25%","37%","47%","58%","68%","78%","88%","100%"]},yaxis:{title:"Network Bandwidth (GB/s)",rangemode:"tozero"},showlegend:F==="all",legend:F==="all"?{orientation:"v",x:1.02,y:1,xanchor:"left"}:void 0,hovermode:"x unified"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsx(H,{sx:{mt:2,mb:1.5}}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,cursor:"pointer",py:1},onClick:()=>nt(!Oe),children:[e.jsx(ee,{size:"small",children:Oe?e.jsx(re,{}):e.jsx(ae,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:500},children:"View the tabular network data across individual nodes"})]}),e.jsx(oe,{in:Oe,children:e.jsx(o,{sx:{scrollMarginTop:"80px"},children:e.jsx(ie,{children:e.jsxs(te,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(l,{sx:{fontWeight:700},children:"Legend"}),e.jsx(l,{sx:{fontWeight:700},children:"Nodes"}),e.jsxs(l,{sx:{fontWeight:700},children:[jt," NVLink"]}),e.jsxs(l,{sx:{fontWeight:700},children:[jt," Slingshot"]})]})}),e.jsx(ne,{children:Gn.map(t=>e.jsxs(_,{children:[e.jsx(l,{children:e.jsx(n,{variant:"body1",sx:{color:t.color,lineHeight:1},children:ye(t.symbol)})}),e.jsx(l,{children:t.node}),e.jsxs(l,{children:[t.nvlink.toFixed(3)," GB/s"]}),e.jsxs(l,{children:[t.slingshot.toFixed(3)," GB/s"]})]},`network-${t.node}`))})]})})})})]}),e.jsxs(E,{id:"roofline",sx:{p:3,mb:3,scrollMarginTop:"80px"},children:[e.jsx(n,{variant:"h6",sx:{...G,mb:2},children:"Roofline Analysis"}),e.jsx(O,{data:cn,layout:{autosize:!0,height:420,margin:{l:80,r:130,t:20,b:70},xaxis:{title:"Operational Intensity (FLOPs/Byte)",range:[0,10],dtick:1,gridcolor:"#d1d5db",griddash:"dot",zeroline:!1},yaxis:{title:"Performance (GFLOPS)",range:[0,25],dtick:5,gridcolor:"#d1d5db",griddash:"dot",zeroline:!1},showlegend:!0,legend:{orientation:"h",x:.5,y:1.14,xanchor:"center"},hovermode:"closest"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}}),e.jsxs(o,{sx:{mt:3},children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,mb:2},children:"Summary & Insights:"}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsxs(p,{item:!0,xs:6,sm:3,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Kernels analyzed"}),e.jsx(n,{variant:"body1",sx:{fontWeight:600},children:"5233"})]}),e.jsxs(p,{item:!0,xs:6,sm:3,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Memory bound kernels"}),e.jsx(n,{variant:"body1",sx:{fontWeight:600},children:"93 (40%)"})]}),e.jsxs(p,{item:!0,xs:6,sm:3,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Compute bound kernels"}),e.jsx(n,{variant:"body1",sx:{fontWeight:600},children:"139 (60%)"})]}),e.jsxs(p,{item:!0,xs:6,sm:3,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Avg. Operational Intensity"}),e.jsx(n,{variant:"body1",sx:{fontWeight:600},children:"2.11710 FLOPs/Byte"})]}),e.jsxs(p,{item:!0,xs:12,sm:6,children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",children:"Avg. Performance"}),e.jsx(n,{variant:"body1",sx:{fontWeight:600},children:"5.50 TFlops"})]})]})]}),e.jsx(H,{sx:{my:3}}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"Optimization Recommendations"}),e.jsx(n,{variant:"body2",sx:{mb:1},children:"Most kernels are compute-bound. To improve performance:"}),e.jsxs(o,{component:"ul",sx:{pl:2,mt:1},children:[e.jsx(n,{component:"li",variant:"body2",sx:{mb:.5},children:"Maximize vectorization and thread/block occupancy."}),e.jsx(n,{component:"li",variant:"body2",sx:{mb:.5},children:"Use optimized math libraries for critical operations."}),e.jsx(n,{component:"li",variant:"body2",sx:{mb:.5},children:"Break dependency chains and unroll loops where beneficial."}),e.jsx(n,{component:"li",variant:"body2",children:"Profile top runtime kernels and target them with micro-optimizations."})]})]}),e.jsxs(p,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:"General Recommendations"}),e.jsxs(o,{component:"ul",sx:{pl:2,mt:1},children:[e.jsx(n,{component:"li",variant:"body2",sx:{mb:.5},children:"Profile outliers: Focus optimization efforts on kernels with highest TFLOPs, or those farthest from the roofline."}),e.jsx(n,{component:"li",variant:"body2",sx:{mb:.5},children:"Balance workloads: For memory-bound kernels near the knee, data access improvements may provide better ROI than compute optimizations."}),e.jsx(n,{component:"li",variant:"body2",children:"Re-run the job after optimizations and compare metrics"})]})]})]}),e.jsx(o,{sx:{mt:3,textAlign:"center"},children:e.jsxs(w,{href:"#",sx:et,children:["Learn how to improve performance"," ",e.jsx(V,{fontSize:"small"})]})})]})]}),e.jsx(p,{item:!0,xs:12,md:"auto",sx:{width:{md:220,lg:240}},children:e.jsxs(o,{sx:{p:2,position:"sticky",top:40},children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,mb:2},children:"On This Page"}),e.jsxs(Gt,{spacing:1,children:[e.jsx(w,{component:"button",onClick:()=>D("job-details"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="job-details"?"primary.main":"text.primary",fontWeight:M==="job-details"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Job Details"}),e.jsx(w,{component:"button",onClick:()=>D("insights"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="insights"?"primary.main":"text.primary",fontWeight:M==="insights"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Insights and Hints"}),e.jsx(w,{component:"button",onClick:()=>D("gpu-throughput"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="gpu-throughput"?"primary.main":"text.primary",fontWeight:M==="gpu-throughput"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"GPU Throughput"}),e.jsx(w,{component:"button",onClick:()=>D("runtime-resource-distribution"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="runtime-resource-distribution"?"primary.main":"text.primary",fontWeight:M==="runtime-resource-distribution"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Resource Utilization Split"}),e.jsx(w,{component:"button",onClick:()=>D("resource-util"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="resource-util"?"primary.main":"text.primary",fontWeight:M==="resource-util"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"GPU/ CPU Utilization"}),e.jsx(w,{component:"button",onClick:()=>D("memory-util"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="memory-util"?"primary.main":"text.primary",fontWeight:M==="memory-util"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Memory Utilization"}),e.jsx(w,{component:"button",onClick:()=>D("gpu-performance"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="gpu-performance"?"primary.main":"text.primary",fontWeight:M==="gpu-performance"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"GPU Performance"}),e.jsx(w,{component:"button",onClick:()=>D("power"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="power"?"primary.main":"text.primary",fontWeight:M==="power"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Power"}),e.jsx(w,{component:"button",onClick:()=>D("pcie-bandwidth"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="pcie-bandwidth"?"primary.main":"text.primary",fontWeight:M==="pcie-bandwidth"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"PCIe Bandwidth"}),e.jsx(w,{component:"button",onClick:()=>D("gpu-inter-node-network"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="gpu-inter-node-network"?"primary.main":"text.primary",fontWeight:M==="gpu-inter-node-network"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"GPU and Inter-Node Network"}),e.jsx(w,{component:"button",onClick:()=>D("roofline"),underline:"hover",variant:"body2",sx:{textAlign:"left",color:M==="roofline"?"primary.main":"text.primary",fontWeight:M==="roofline"?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:"Roofline Analysis"})]})]})})]})]})]}):e.jsx(o,{sx:{p:3},children:e.jsx(n,{children:"Loading..."})})};export{Cr as component};
