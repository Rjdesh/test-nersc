import{aE as T,d as i,j as e,C as S,e as k,L as v,h as E,T as a,B as u,P as w,S as A}from"./index-CYwz6NOt.js";import{N as _}from"./NavigateNext-5cPhuCug.js";import{P as I}from"./react-plotly-N1asVEom.js";import{u as M}from"./useDataFromSource-CYeP9Hjr.js";import{A as N}from"./Alert-D9B5RkcU.js";import{G as g}from"./Grid-HghZybvF.js";import"./index-Chjiymov.js";import"./Close-C-5r-21X.js";const C=new Set(["Job ID","Floored Relative Time"]),h=l=>l.replace("nersc_ldms_dcgm_","").replace(/_/g," "),j=l=>`metric-${l.replace(/[^a-zA-Z0-9_-]/g,"-")}`,G=function(){const{id:d}=T.useParams(),[m,f]=i.useState(""),s=M("data/user-job-performance/metrics-data.json"),r=i.useMemo(()=>(s==null?void 0:s[d])??[],[s,d]),c=i.useMemo(()=>r.length?Object.keys(r[0]).filter(o=>!C.has(o)):[],[r]),b=r.length>0&&c.length>0,n=i.useMemo(()=>c.map(o=>j(o)),[c]);i.useEffect(()=>{n.length&&!m&&f(n[0])},[n,m]),i.useEffect(()=>{const o=()=>{const t=window.scrollY+100;for(let p=n.length-1;p>=0;p-=1){const x=n[p],y=document.getElementById(x);if(y&&y.offsetTop<=t){f(x);break}}};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[n]);const P=o=>{const t=document.getElementById(o);if(!t)return;const x=t.offsetTop-80;window.scrollTo({top:x,behavior:"smooth"}),f(o)};return e.jsxs(S,{maxWidth:"xl",sx:{py:3},children:[e.jsxs(k,{separator:e.jsx(_,{fontSize:"small"}),sx:{mb:2},children:[e.jsx(v,{component:E,to:"/user-job-performance",underline:"hover",color:"primary",children:"For Users"}),e.jsx(a,{color:"text.primary",children:"Job Performance"})]}),e.jsxs(u,{sx:{mb:3},children:[e.jsxs(a,{variant:"h4",sx:{fontWeight:700},children:["Performance Widgets for Job ",d]}),e.jsx(a,{variant:"body1",color:"text.secondary",children:"Time-series charts and tabular metrics from collected HPC telemetry."})]}),!s&&e.jsx(w,{sx:{p:3},children:e.jsx(a,{children:"Loading metrics data..."})}),s&&!b&&e.jsxs(N,{severity:"warning",children:["No metrics were found for job ",e.jsx("strong",{children:d})," in `metrics-data.json`."]}),b&&e.jsxs(g,{container:!0,spacing:3,children:[e.jsx(g,{item:!0,xs:12,md:9,lg:9,children:e.jsx(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:c.map(o=>e.jsxs(w,{id:j(o),sx:{p:3,scrollMarginTop:24},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600,mb:2},children:h(o)}),e.jsx(I,{data:[{x:r.map(t=>t["Floored Relative Time"]),y:r.map(t=>t[o]),type:"scatter",mode:"lines+markers",name:h(o),line:{width:2,color:"#1976d2"},marker:{size:4}}],layout:{autosize:!0,height:320,margin:{l:60,r:20,t:20,b:50},xaxis:{title:"Relative Time (s)",gridcolor:"#ececec"},yaxis:{title:h(o),gridcolor:"#ececec"},plot_bgcolor:"white",paper_bgcolor:"white"},config:{responsive:!0,displayModeBar:!1},style:{width:"100%"}})]},o))})}),e.jsx(g,{item:!0,xs:12,md:"auto",sx:{width:{md:220,lg:240}},children:e.jsxs(u,{sx:{p:2,position:"sticky",top:40},children:[e.jsx(a,{variant:"subtitle2",sx:{fontWeight:600,mb:2},children:"On This Page"}),e.jsx(A,{spacing:1,children:c.map(o=>{const t=j(o);return e.jsx(v,{component:"button",onClick:()=>P(t),underline:"hover",variant:"body2",sx:{textAlign:"left",color:m===t?"primary.main":"text.primary",fontWeight:m===t?600:400,cursor:"pointer",border:"none",background:"none",padding:0},children:h(o)},o)})})]})})]})]})};export{G as component};
